<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>填色游戏管理后台</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/admin.css">
</head>
<body>
    <!-- 加载遮罩 -->
    <div id="loading-overlay" class="loading-overlay d-none">
        <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status">
            <span class="visually-hidden">加载中...</span>
        </div>
    </div>

    <!-- 通知提示容器 -->
    <div class="toast-container"></div>

    <div class="container-fluid">
        <div class="row">
            <!-- 侧边栏 -->
            <nav id="sidebar" class="col-md-3 col-lg-2 d-md-block bg-dark sidebar collapse">
                <div class="position-sticky pt-3">
                    <div class="text-center mb-4">
                        <h4 class="text-white fw-bold">填色游戏管理系统</h4>
                        <p class="text-light opacity-75 small">v1.0.0</p>
                    </div>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link active" href="#" data-page="dashboard">
                                <i class="bi bi-speedometer2"></i>控制面板
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-page="banners">
                                <i class="bi bi-images"></i>Banner管理
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-page="categories">
                                <i class="bi bi-folder"></i>分类管理
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-page="pictures">
                                <i class="bi bi-image"></i>图片管理
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-page="users">
                                <i class="bi bi-people"></i>用户管理
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-page="logs">
                                <i class="bi bi-journal-text"></i>系统日志
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-page="settings">
                                <i class="bi bi-gear"></i>系统设置
                            </a>
                        </li>
                    </ul>
                    <hr class="text-white-50">
                    <div class="px-3 mt-4">
                        <div class="d-flex align-items-center mb-3">
                            <div class="flex-shrink-0">
                                <div class="avatar bg-primary text-white rounded-circle d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;">
                                    <i class="bi bi-person"></i>
                                </div>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="text-white mb-0" id="current-user">管理员</h6>
                                <small class="text-white-50" id="user-role">管理员</small>
                            </div>
                        </div>
                        <button id="logoutBtn" class="btn btn-outline-light btn-sm w-100">
                            <i class="bi bi-box-arrow-right me-2"></i>退出登录
                        </button>
                    </div>
                </div>
            </nav>

            <!-- 主内容区 -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4 py-4">
                <!-- 移动端顶部导航 -->
                <nav class="navbar navbar-light d-md-none bg-light fixed-top px-3">
                    <div class="container-fluid">
                        <button class="navbar-toggler" type="button" id="sidebarToggle">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                        <span class="navbar-brand">填色游戏管理系统</span>
                    </div>
                </nav>

                <div id="content-area" class="mt-md-0 mt-5">
                    <!-- 仪表盘 -->
                    <div id="dashboard-page" class="content-page active">
                        <h2 class="page-title">控制面板</h2>
                        
                        <div class="row mb-4">
                            <div class="col-md-3 mb-4">
                                <div class="card h-100">
                                    <div class="stat-card primary">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <div>
                                                <p class="mb-0">用户总数</p>
                                                <h2 id="total-users">--</h2>
                                            </div>
                                            <div>
                                                <i class="bi bi-people fs-1"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 mb-4">
                                <div class="card h-100">
                                    <div class="stat-card success">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <div>
                                                <p class="mb-0">图片总数</p>
                                                <h2 id="total-pictures">--</h2>
                                            </div>
                                            <div>
                                                <i class="bi bi-image fs-1"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 mb-4">
                                <div class="card h-100">
                                    <div class="stat-card info">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <div>
                                                <p class="mb-0">分类总数</p>
                                                <h2 id="total-categories">--</h2>
                                            </div>
                                            <div>
                                                <i class="bi bi-folder fs-1"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 mb-4">
                                <div class="card h-100">
                                    <div class="stat-card warning">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <div>
                                                <p class="mb-0">今日活跃用户</p>
                                                <h2 id="active-users">--</h2>
                                            </div>
                                            <div>
                                                <i class="bi bi-person-check fs-1"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-8 mb-4">
                                <div class="card">
                                    <div class="card-body">
                                        <h5 class="card-title">最近7天活跃用户统计</h5>
                                        <div class="chart-container" style="position: relative; height:300px;">
                                            <canvas id="userActivityChart"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4 mb-4">
                                <div class="card h-100">
                                    <div class="card-body">
                                        <h5 class="card-title">系统状态</h5>
                                        <div class="mt-4">
                                            <div id="server-status">
                                                <div class="d-flex justify-content-between align-items-center mb-3">
                                                    <span>服务器状态</span>
                                                    <span class="badge bg-secondary">检测中...</span>
                                                </div>
                                            </div>
                                            <div id="db-status">
                                                <div class="d-flex justify-content-between align-items-center mb-3">
                                                    <span>数据库连接</span>
                                                    <span class="badge bg-secondary">检测中...</span>
                                                </div>
                                            </div>
                                            <div id="api-status">
                                                <div class="d-flex justify-content-between align-items-center mb-3">
                                                    <span>API 状态</span>
                                                    <span class="badge bg-secondary">检测中...</span>
                                                </div>
                                            </div>
                                            <div id="system-load">
                                                <div class="d-flex justify-content-between align-items-center mb-3">
                                                    <span>系统负载</span>
                                                    <div class="progress" style="width: 60%;">
                                                        <div class="progress-bar" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div id="storage-space">
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <span>存储空间</span>
                                                    <div class="progress" style="width: 60%;">
                                                        <div class="progress-bar" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 系统日志页面 -->
                    <div id="logs-page" class="content-page">
                        <h2 class="page-title">系统日志</h2>
                        
                        <div class="card mb-4">
                            <div class="card-body">
                                <div class="d-flex justify-content-between mb-3">
                                    <div>
                                        <h5 class="card-title">操作日志列表</h5>
                                        <p class="text-muted">记录系统中的重要操作</p>
                                    </div>
                                    <div>
                                        <div class="btn-group">
                                            <button class="btn btn-sm btn-outline-secondary">今天</button>
                                            <button class="btn btn-sm btn-outline-secondary">本周</button>
                                            <button class="btn btn-sm btn-outline-secondary">本月</button>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="table-responsive">
                                    <table class="table table-striped table-hover">
                                        <thead>
                                            <tr>
                                                <th>时间</th>
                                                <th>用户</th>
                                                <th>操作类型</th>
                                                <th>详情</th>
                                                <th>IP地址</th>
                                                <th>状态</th>
                                            </tr>
                                        </thead>
                                        <tbody id="logs-table-body">
                                            <tr>
                                                <td>2024-03-26 16:30:45</td>
                                                <td>admin</td>
                                                <td>登录</td>
                                                <td>用户登录成功</td>
                                                <td>127.0.0.1</td>
                                                <td><span class="badge bg-success">成功</span></td>
                                            </tr>
                                            <tr>
                                                <td>2024-03-26 16:35:12</td>
                                                <td>admin</td>
                                                <td>图片上传</td>
                                                <td>上传新图片"春日风景"</td>
                                                <td>127.0.0.1</td>
                                                <td><span class="badge bg-success">成功</span></td>
                                            </tr>
                                            <tr>
                                                <td>2024-03-26 16:40:23</td>
                                                <td>admin</td>
                                                <td>分类管理</td>
                                                <td>创建新分类"动物世界"</td>
                                                <td>127.0.0.1</td>
                                                <td><span class="badge bg-success">成功</span></td>
                                            </tr>
                                            <tr>
                                                <td>2024-03-26 16:42:47</td>
                                                <td>system</td>
                                                <td>系统通知</td>
                                                <td>数据库自动备份</td>
                                                <td>-</td>
                                                <td><span class="badge bg-info">信息</span></td>
                                            </tr>
                                            <tr>
                                                <td>2024-03-26 16:45:18</td>
                                                <td>admin</td>
                                                <td>用户管理</td>
                                                <td>修改用户"user123"的权限</td>
                                                <td>127.0.0.1</td>
                                                <td><span class="badge bg-success">成功</span></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                
                                <nav aria-label="日志分页" class="mt-4">
                                    <ul class="pagination justify-content-center">
                                        <li class="page-item disabled">
                                            <a class="page-link" href="#" tabindex="-1" aria-disabled="true">上一页</a>
                                        </li>
                                        <li class="page-item active"><a class="page-link" href="#">1</a></li>
                                        <li class="page-item"><a class="page-link" href="#">2</a></li>
                                        <li class="page-item"><a class="page-link" href="#">3</a></li>
                                        <li class="page-item">
                                            <a class="page-link" href="#">下一页</a>
                                        </li>
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 系统设置页面 -->
                    <div id="settings-page" class="content-page">
                        <h2 class="page-title">系统设置</h2>
                        
                        <div class="row">
                            <div class="col-md-8">
                                <div class="card mb-4">
                                    <div class="card-body">
                                        <h5 class="card-title mb-4">基本设置</h5>
                                        
                                        <form id="basic-settings-form">
                                            <div class="mb-3">
                                                <label for="site-name" class="form-label">网站名称</label>
                                                <input type="text" class="form-control" id="site-name" value="填色游戏管理系统">
                                            </div>
                                            
                                            <div class="mb-3">
                                                <label for="site-description" class="form-label">网站描述</label>
                                                <textarea class="form-control" id="site-description" rows="3">一个优秀的填色游戏管理系统，提供丰富的填色内容和管理功能。</textarea>
                                            </div>
                                            
                                            <div class="mb-3">
                                                <label for="contact-email" class="form-label">联系邮箱</label>
                                                <input type="email" class="form-control" id="contact-email" value="admin@example.com">
                                            </div>
                                            
                                            <div class="mb-3">
                                                <label for="logo-upload" class="form-label">网站Logo</label>
                                                <input type="file" class="form-control" id="logo-upload">
                                            </div>
                                            
                                            <div class="mb-3">
                                                <label class="form-label d-block">网站状态</label>
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input" type="radio" name="site-status" id="site-status-online" value="online" checked>
                                                    <label class="form-check-label" for="site-status-online">正常运行</label>
                                                </div>
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input" type="radio" name="site-status" id="site-status-maintenance" value="maintenance">
                                                    <label class="form-check-label" for="site-status-maintenance">维护模式</label>
                                                </div>
                                            </div>
                                            
                                            <button type="submit" class="btn btn-primary">保存设置</button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-4">
                                <div class="card mb-4">
                                    <div class="card-body">
                                        <h5 class="card-title mb-4">系统信息</h5>
                                        
                                        <ul class="list-group list-group-flush">
                                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                                系统版本
                                                <span class="badge bg-primary rounded-pill">v1.0.0</span>
                                            </li>
                                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                                服务器环境
                                                <span>Node.js v22.13.1</span>
                                            </li>
                                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                                数据库
                                                <span>MongoDB v6.13.0</span>
                                            </li>
                                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                                最后更新
                                                <span>2024-03-26</span>
                                            </li>
                                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                                运行时间
                                                <span>2天14小时32分钟</span>
                                            </li>
                                        </ul>
                                        
                                        <div class="d-grid gap-2 mt-3">
                                            <button class="btn btn-outline-secondary" type="button">检查更新</button>
                                            <button class="btn btn-outline-danger" type="button">清除缓存</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Banner管理页面 -->
                    <div id="banners-page" class="content-page">
                        <h2 class="page-title">Banner管理</h2>
                        
                        <div class="card mb-4">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-center mb-4">
                                    <h5 class="card-title mb-0">Banner列表</h5>
                                    <button type="button" class="btn btn-primary" id="addBannerBtn">
                                        <i class="bi bi-plus"></i> 添加Banner
                                    </button>
                                </div>
                                
                                <div class="table-responsive">
                                    <table class="table table-striped table-hover">
                                        <thead>
                                            <tr>
                                                <th width="5%">排序</th>
                                                <th width="15%">图片</th>
                                                <th width="40%">跳转链接</th>
                                                <th width="15%">状态</th>
                                                <th width="10%">显示顺序</th>
                                                <th width="15%">操作</th>
                                            </tr>
                                        </thead>
                                        <tbody id="banners-table-body">
                                            <!-- Banner列表将在这里动态加载 -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 分类管理页面 -->
                    <div id="categories-page" class="content-page">
                        <h2 class="page-title">分类管理</h2>
                        
                        <div class="row">
                            <div class="col-md-4">
                                <div class="card mb-4">
                                    <div class="card-body">
                                        <h5 class="card-title mb-3">添加/编辑分类</h5>
                                        <form id="categoryForm">
                                            <input type="hidden" id="categoryId" value="">
                                            
                                            <div class="mb-3">
                                                <label for="categoryName" class="form-label">分类名称</label>
                                                <input type="text" class="form-control" id="categoryName" placeholder="输入分类名称" required>
                                            </div>
                                            
                                            <div class="mb-3">
                                                <label for="categoryDesc" class="form-label">分类描述</label>
                                                <textarea class="form-control" id="categoryDesc" rows="3" placeholder="输入分类描述"></textarea>
                                            </div>
                                            
                                            <div class="mb-3">
                                                <label for="categoryOrder" class="form-label">显示顺序</label>
                                                <input type="number" class="form-control" id="categoryOrder" min="1" value="1">
                                                <div class="form-text">数字越小越靠前显示。</div>
                                            </div>
                                            
                                            <div class="mb-3">
                                                <label for="categoryIcon" class="form-label">分类图标</label>
                                                <div class="input-group mb-3">
                                                    <input type="file" class="form-control" id="categoryIcon" accept="image/*">
                                                    <button class="btn btn-outline-secondary" type="button" id="uploadIconBtn">上传</button>
                                                </div>
                                                <div id="categoryIconPreview" class="mt-2 d-none">
                                                    <img id="iconPreview" src="" alt="图标预览" class="img-fluid img-thumbnail" style="max-height: 100px;">
                                                </div>
                                            </div>
                                            
                                            <div class="mb-3">
                                                <label class="form-label d-block">状态</label>
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input" type="radio" name="categoryStatus" id="categoryStatusActive" value="active" checked>
                                                    <label class="form-check-label" for="categoryStatusActive">启用</label>
                                                </div>
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input" type="radio" name="categoryStatus" id="categoryStatusInactive" value="inactive">
                                                    <label class="form-check-label" for="categoryStatusInactive">禁用</label>
                                                </div>
                                            </div>
                                            
                                            <div class="d-grid gap-2">
                                                <button type="submit" class="btn btn-primary" id="saveCategoryBtn">
                                                    <i class="bi bi-save"></i> 保存分类
                                                </button>
                                                <button type="button" class="btn btn-outline-secondary" id="resetCategoryBtn">
                                                    <i class="bi bi-arrow-counterclockwise"></i> 重置
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-8">
                                <div class="card mb-4">
                                    <div class="card-body">
                                        <h5 class="card-title mb-3">分类列表</h5>
                                        
                                        <div class="table-responsive">
                                            <table class="table table-striped table-hover">
                                                <thead>
                                                    <tr>
                                                        <th width="5%">排序</th>
                                                        <th width="10%">图标</th>
                                                        <th width="20%">名称</th>
                                                        <th width="30%">描述</th>
                                                        <th width="10%">图片数</th>
                                                        <th width="10%">状态</th>
                                                        <th width="15%">操作</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="categories-table-body">
                                                    <tr>
                                                        <td>
                                                            <div class="d-flex flex-column">
                                                                <button class="btn btn-sm btn-light mb-1"><i class="bi bi-arrow-up"></i></button>
                                                                <button class="btn btn-sm btn-light"><i class="bi bi-arrow-down"></i></button>
                                                            </div>
                                                        </td>
                                                        <td>
                                                            <img src="https://via.placeholder.com/40" alt="分类图标" class="img-thumbnail">
                                                        </td>
                                                        <td>动物世界</td>
                                                        <td>各种可爱的动物填色图片</td>
                                                        <td>32</td>
                                                        <td>
                                                            <span class="badge bg-success">已启用</span>
                                                        </td>
                                                        <td>
                                                            <div class="btn-group btn-group-sm">
                                                                <button class="btn btn-outline-primary edit-category-btn" data-id="1">
                                                                    <i class="bi bi-pencil"></i>
                                                                </button>
                                                                <button class="btn btn-outline-danger delete-category-btn" data-id="1">
                                                                    <i class="bi bi-trash"></i>
                                                                </button>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <div class="d-flex flex-column">
                                                                <button class="btn btn-sm btn-light mb-1"><i class="bi bi-arrow-up"></i></button>
                                                                <button class="btn btn-sm btn-light"><i class="bi bi-arrow-down"></i></button>
                                                            </div>
                                                        </td>
                                                        <td>
                                                            <img src="https://via.placeholder.com/40/ff9" alt="分类图标" class="img-thumbnail">
                                                        </td>
                                                        <td>风景名胜</td>
                                                        <td>世界各地美丽风景</td>
                                                        <td>28</td>
                                                        <td>
                                                            <span class="badge bg-success">已启用</span>
                                                        </td>
                                                        <td>
                                                            <div class="btn-group btn-group-sm">
                                                                <button class="btn btn-outline-primary edit-category-btn" data-id="2">
                                                                    <i class="bi bi-pencil"></i>
                                                                </button>
                                                                <button class="btn btn-outline-danger delete-category-btn" data-id="2">
                                                                    <i class="bi bi-trash"></i>
                                                                </button>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <div class="d-flex flex-column">
                                                                <button class="btn btn-sm btn-light mb-1"><i class="bi bi-arrow-up"></i></button>
                                                                <button class="btn btn-sm btn-light"><i class="bi bi-arrow-down"></i></button>
                                                            </div>
                                                        </td>
                                                        <td>
                                                            <img src="https://via.placeholder.com/40/f99" alt="分类图标" class="img-thumbnail">
                                                        </td>
                                                        <td>花卉植物</td>
                                                        <td>各种美丽的花卉植物</td>
                                                        <td>45</td>
                                                        <td>
                                                            <span class="badge bg-success">已启用</span>
                                                        </td>
                                                        <td>
                                                            <div class="btn-group btn-group-sm">
                                                                <button class="btn btn-outline-primary edit-category-btn" data-id="3">
                                                                    <i class="bi bi-pencil"></i>
                                                                </button>
                                                                <button class="btn btn-outline-danger delete-category-btn" data-id="3">
                                                                    <i class="bi bi-trash"></i>
                                                                </button>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 图片管理页面 -->
                    <div id="pictures-page" class="content-page">
                        <h2 class="page-title">图片管理</h2>
                        <div class="card">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-center mb-4">
                                    <button class="btn btn-primary" id="add-picture-btn">
                                        <i class="bi bi-plus-circle me-2"></i>添加图片
                                    </button>
                                    <div class="d-flex gap-2">
                                        <input type="text" class="form-control" id="search-pictures" placeholder="搜索图片...">
                                        <select class="form-select" id="category-filter">
                                            <option value="">全部分类</option>
                                        </select>
                                    </div>
                                </div>
                                <div id="pictures-container">
                                    <!-- 图片列表将在这里动态加载 -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 用户管理页面 -->
                    <div id="users-page" class="content-page">
                        <div class="container-fluid">
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <h2>用户管理</h2>
                                </div>
                                <div class="col-md-6 text-end">
                                    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#userModal">
                                        <i class="bi bi-plus-circle"></i> 添加用户
                                    </button>
                                </div>
                            </div>

                            <div class="card">
                                <div class="card-header">
                                    <div class="row align-items-center">
                                        <div class="col">
                                            <input type="text" class="form-control" id="userSearch" placeholder="搜索用户名或邮箱...">
                                        </div>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-striped table-hover">
                                            <thead>
                                                <tr>
                                                    <th>用户名</th>
                                                    <th>邮箱</th>
                                                    <th>角色</th>
                                                    <th>状态</th>
                                                    <th>创建时间</th>
                                                    <th>最后登录</th>
                                                    <th>完成图片</th>
                                                    <th>操作</th>
                                                </tr>
                                            </thead>
                                            <tbody id="users-table-body">
                                                <!-- 用户数据将通过JavaScript动态填充 -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- 登录模态框 -->
    <div class="modal fade" id="loginModal" tabindex="-1" aria-hidden="true" data-bs-backdrop="static">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0 shadow">
                <div class="modal-header border-0 pb-0">
                    <h4 class="modal-title fw-bold">管理员登录</h4>
                </div>
                <div class="modal-body pt-0">
                    <p class="text-muted mb-4">请输入您的管理员账号密码</p>
                    <form id="loginForm">
                        <div class="mb-3">
                            <label for="username" class="form-label">用户名</label>
                            <div class="input-group">
                                <span class="input-group-text bg-light border-end-0">
                                    <i class="bi bi-person"></i>
                                </span>
                                <input type="text" class="form-control border-start-0" id="username" placeholder="请输入用户名" required>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="password" class="form-label">密码</label>
                            <div class="input-group">
                                <span class="input-group-text bg-light border-end-0">
                                    <i class="bi bi-lock"></i>
                                </span>
                                <input type="password" class="form-control border-start-0" id="password" placeholder="请输入密码" required>
                            </div>
                        </div>
                        <div id="loginError" class="alert alert-danger d-none"></div>
                        <div class="d-grid gap-2 mt-4">
                            <button type="submit" class="btn btn-primary btn-lg">登录</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Banner添加/编辑模态框 -->
    <div class="modal fade" id="bannerModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content border-0 shadow">
                <div class="modal-header">
                    <h5 class="modal-title" id="bannerModalTitle">添加Banner</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="bannerForm">
                        <input type="hidden" id="bannerId" value="">
                        
                        <div class="mb-3">
                            <label for="bannerImage" class="form-label">Banner图片</label>
                            <div class="input-group mb-3">
                                <input type="file" class="form-control" id="bannerImage" accept="image/*">
                                <button class="btn btn-outline-secondary" type="button" id="uploadBannerBtn">上传</button>
                            </div>
                            <div id="bannerPreviewContainer" class="mt-2 d-none">
                                <img id="bannerPreview" src="" alt="Banner预览" class="img-fluid img-thumbnail" style="max-height: 200px;">
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label for="bannerLink" class="form-label">跳转链接</label>
                            <input type="text" class="form-control" id="bannerLink" placeholder="输入跳转链接，如：https://example.com/page">
                            <div class="form-text">当用户点击Banner时将跳转到此链接。</div>
                        </div>
                        
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="bannerOrder" class="form-label">显示顺序</label>
                                <input type="number" class="form-control" id="bannerOrder" min="1" value="1">
                                <div class="form-text">数字越小越靠前显示。</div>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label d-block">状态</label>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="bannerStatus" id="bannerStatusActive" value="active" checked>
                                    <label class="form-check-label" for="bannerStatusActive">启用</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="bannerStatus" id="bannerStatusInactive" value="inactive">
                                    <label class="form-check-label" for="bannerStatusInactive">禁用</label>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-primary" id="saveBannerBtn">保存</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 图片添加/编辑模态框 -->
    <div class="modal fade" id="pictureModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content border-0 shadow">
                <div class="modal-header">
                    <h5 class="modal-title" id="pictureModalTitle">添加图片</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="pictureForm">
                        <input type="hidden" id="pictureId" value="">
                        
                        <div class="row mb-3">
                            <div class="col-md-8">
                                <div class="mb-3">
                                    <label for="pictureTitle" class="form-label">图片标题</label>
                                    <input type="text" class="form-control" id="pictureTitle" placeholder="输入图片标题" required>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="pictureDescription" class="form-label">图片描述</label>
                                    <textarea class="form-control" id="pictureDescription" rows="3" placeholder="输入图片描述"></textarea>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="pictureCategory" class="form-label">所属分类</label>
                                    <select class="form-select" id="pictureCategory" required>
                                        <option value="">选择分类</option>
                                        <option value="1">动物世界</option>
                                        <option value="2">风景名胜</option>
                                        <option value="3">花卉植物</option>
                                    </select>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">图片标签</label>
                                    <div>
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="checkbox" id="tagNew" value="new">
                                            <label class="form-check-label" for="tagNew">New</label>
                                        </div>
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="checkbox" id="tagBlend" value="blend">
                                            <label class="form-check-label" for="tagBlend">Blend</label>
                                        </div>
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="checkbox" id="tagRare" value="rare">
                                            <label class="form-check-label" for="tagRare">Rare</label>
                                        </div>
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="checkbox" id="tagLimited" value="limited">
                                            <label class="form-check-label" for="tagLimited">Limited Time Offer</label>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="pictureRarity" class="form-label">稀有度</label>
                                    <select class="form-select" id="pictureRarity">
                                        <option value="common">普通 (Common)</option>
                                        <option value="uncommon">不常见 (Uncommon)</option>
                                        <option value="rare">稀有 (Rare)</option>
                                        <option value="epic">史诗 (Epic)</option>
                                        <option value="legendary">传说 (Legendary)</option>
                                        <option value="limited">限定 (Limited)</option>
                                    </select>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="pictureOrder" class="form-label">显示顺序</label>
                                    <input type="number" class="form-control" id="pictureOrder" min="1" value="1">
                                    <div class="form-text">数字越小越靠前显示。</div>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label d-block">状态</label>
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="pictureStatus" id="pictureStatusActive" value="active" checked>
                                        <label class="form-check-label" for="pictureStatusActive">启用</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="pictureStatus" id="pictureStatusInactive" value="inactive">
                                        <label class="form-check-label" for="pictureStatusInactive">禁用</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="pictureImage" class="form-label">图片上传</label>
                                    <div class="input-group mb-3">
                                        <input type="file" class="form-control" id="pictureImage" accept="image/*">
                                        <button class="btn btn-outline-secondary" type="button" id="uploadPictureBtn">上传</button>
                                    </div>
                                    <div id="picturePreviewContainer" class="mt-2 d-none">
                                        <img id="picturePreview" src="" alt="图片预览" class="img-fluid img-thumbnail">
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="pictureThumbnail" class="form-label">缩略图上传</label>
                                    <div class="input-group mb-3">
                                        <input type="file" class="form-control" id="pictureThumbnail" accept="image/*">
                                        <button class="btn btn-outline-secondary" type="button" id="uploadThumbnailBtn">上传</button>
                                    </div>
                                    <div id="thumbnailPreviewContainer" class="mt-2 d-none">
                                        <img id="thumbnailPreview" src="" alt="缩略图预览" class="img-fluid img-thumbnail">
                                    </div>
                                    <div class="form-text">如不上传，系统将自动生成。</div>
                                </div>
                                
                                <div class="card mt-3">
                                    <div class="card-header bg-light">解锁设置</div>
                                    <div class="card-body">
                                        <div class="mb-3">
                                            <label for="unlockType" class="form-label">解锁方式</label>
                                            <select class="form-select" id="unlockType">
                                                <option value="free">免费</option>
                                                <option value="coins">金币</option>
                                                <option value="level">等级</option>
                                            </select>
                                        </div>
                                        
                                        <div class="mb-3" id="unlockValueContainer">
                                            <label for="unlockValue" class="form-label">解锁值</label>
                                            <input type="number" class="form-control" id="unlockValue" min="0" value="0">
                                            <div class="form-text">金币数量或最低等级</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-primary" id="savePictureBtn">保存</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 用户编辑模态框 -->
    <div class="modal fade" id="userModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="userModalTitle">添加用户</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="userForm">
                        <input type="hidden" id="userId">
                        <div class="mb-3">
                            <label for="username" class="form-label">用户名</label>
                            <input type="text" class="form-control" id="username" required>
                        </div>
                        <div class="mb-3">
                            <label for="email" class="form-label">邮箱</label>
                            <input type="email" class="form-control" id="email" required>
                        </div>
                        <div class="mb-3">
                            <label for="password" class="form-label">密码</label>
                            <input type="password" class="form-control" id="password">
                            <small class="text-muted">编辑时留空表示不修改密码</small>
                        </div>
                        <div class="mb-3">
                            <label for="userRole" class="form-label">角色</label>
                            <select class="form-select" id="userRole" required>
                                <option value="">请选择角色</option>
                                <option value="admin">管理员</option>
                                <option value="user">普通用户</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="userStatus" class="form-label">状态</label>
                            <select class="form-select" id="userStatus" required>
                                <option value="">请选择状态</option>
                                <option value="active">启用</option>
                                <option value="inactive">禁用</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-primary" onclick="saveUser()">保存</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 测试区域：直接访问图片 -->
    <div style="background: #f5f5f5; padding: 20px; margin-top: 50px; border-radius: 8px;">
        <h3>图片加载测试</h3>
        <p>以下是直接从uploads目录加载的图片，用于测试图片路径是否正确：</p>
        <div class="row">
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">直接路径</div>
                    <div class="card-body">
                        <img src="/uploads/1738563072239-蛇红包.png" alt="测试图片1" class="img-fluid" style="max-height: 200px;" onerror="this.src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAACgCAMAAAC8EZcfAAAAWlBMVEX////29vaysrLy8vLu7u6np6fOzs7i4uK+vr7Z2dnCwsL8/Px5eXny8vLj4+NbW1s3NzcZGRkoKCgAAADe3t5ra2upqalQUFA/Pz8hISF+fn5ISEgQEBBjY2OTMQRGAAADuElEQVR4nO2b27KCMAxFCy1yv4hyfP//Mw+CgJZb23RX9jhrXmacZZuSpmkKgYODg4ODg4ODg4ODN3TNoF3NL2ikzz36Ql/UjfRZbBSVxTNKr9J/LGLhu6LFE2lctNJnYyEtXH5n6DIdTVqyWlsM9Pl+wUqe9hJVaeCbnGFoGKxHyTo0uG9jGbp7vFpv0nUB/kBKf77fsSl1wJM0qW8Y76Hu4P7Sdb2W79eiCwbDFT3yHnriogqmhsrJDj0PspBdQW1R1nI5byCwQmVVTb2BDcqrjBxpPLUEKJwPGHZvIIfCqlIXjWcmBqgKUuFEGHkWmK29GBRI0zzVQkgKVU4yxiIwXEWpZPQipPCaO0Y2SuiCUmYYRb0cSgtOJ+lzMw9FYnL8/SyvQ5nUmBnCrFy6raaLJiYG/lVgZIx5eXlGxK9nZqHCk4sJFYaYP2VkpYWi98T/xT2iFrbsH9FvWmF2cqoGF0bMn20+5vYSvOqkf0RYW/mZXNKwrj1A93CcvdU/obCWXGVTsEVXYH6i8wIiXaS4w/XwJEyFKxVqqOJu4YKmhQuwsY9YHw8OTaHfsCMVMECdmNzg/HcxQLqMJSp44P7Kh5pxeAstQRRtgIMKVHH3XK7RQc1ckPGE1kC41qUQbXSyZ28E+Iu5iQEGTJJnYv1aQsEkSNQOeJxMaXOTQFrFRpRZMh4hsMEklS3wvIdAo2hKfWqGQANp5eoQ3nwG2qg31qeNmYuIVe+JtUCUQqXRZdQBnwEX9JmTJ/Sx4V+QeAjc2C7gW+GWAlM7RdLw97EtBdaJjeL7/UBbxUcNNCM0y6cPB04/+6u5YwuFL7z9sMUPLdT9Ixt96uKjkY0+9rLcKz92W2ivdLZTCVa0ggtc4AIXuMAfFsiJOqhSR0wbOYh5GRrZyOh5rlVVm6hBIRuF5L7lFhpFlOl0uH4Z9OD9HaGHttlE51dZPQQ1NuNoU5Kyi+ELG0nNVE3dXGkfE7XMiJtuYx2w/3ixk2QMNc3ESMF4JEn7GrfQSTqcAd6VsMXFl0C+BJdgWuXnwMmgwlmyYgORQW8Tn9j1NdE7qTcKbQNaUCh0d7sZuKBw6lDioUdwIREW9KDXWe9x92kI7fZTvzSYwMv4Fw3E6MNfN2BRpYr/8wY3ChAG5tgoPJLu+6WGFyeq/qMGMPnPNXDhqwKvLvBR6TGd3qS3c/i93f1Ow+4dXsxvcHBwcHBwcHBwcHAgxTeZqyq9wtAXIgAAAABJRU5ErkJggg=='; console.log('图片1加载失败');">
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">完整URL</div>
                    <div class="card-body">
                        <img src="http://localhost:3000/uploads/1738563072239-蛇红包.png" alt="测试图片2" class="img-fluid" style="max-height: 200px;" onerror="this.src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAACgCAMAAAC8EZcfAAAAWlBMVEX////29vaysrLy8vLu7u6np6fOzs7i4uK+vr7Z2dnCwsL8/Px5eXny8vLj4+NbW1s3NzcZGRkoKCgAAADe3t5ra2upqalQUFA/Pz8hISF+fn5ISEgQEBBjY2OTMQRGAAADuElEQVR4nO2b27KCMAxFCy1yv4hyfP//Mw+CgJZb23RX9jhrXmacZZuSpmkKgYODg4ODg4ODg4ODN3TNoF3NL2ikzz36Ql/UjfRZbBSVxTNKr9J/LGLhu6LFE2lctNJnYyEtXH5n6DIdTVqyWlsM9Pl+wUqe9hJVaeCbnGFoGKxHyTo0uG9jGbp7vFpv0nUB/kBKf77fsSl1wJM0qW8Y76Hu4P7Sdb2W79eiCwbDFT3yHnriogqmhsrJDj0PspBdQW1R1nI5byCwQmVVTb2BDcqrjBxpPLUEKJwPGHZvIIfCqlIXjWcmBqgKUuFEGHkWmK29GBRI0zzVQkgKVU4yxiIwXEWpZPQipPCaO0Y2SuiCUmYYRb0cSgtOJ+lzMw9FYnL8/SyvQ5nUmBnCrFy6raaLJiYG/lVgZIx5eXlGxK9nZqHCk4sJFYaYP2VkpYWi98T/xT2iFrbsH9FvWmF2cqoGF0bMn20+5vYSvOqkf0RYW/mZXNKwrj1A93CcvdU/obCWXGVTsEVXYH6i8wIiXaS4w/XwJEyFKxVqqOJu4YKmhQuwsY9YHw8OTaHfsCMVMECdmNzg/HcxQLqMJSp44P7Kh5pxeAstQRRtgIMKVHH3XK7RQc1ckPGE1kC41qUQbXSyZ28E+Iu5iQEGTJJnYv1aQsEkSNQOeJxMaXOTQFrFRpRZMh4hsMEklS3wvIdAo2hKfWqGQANp5eoQ3nwG2qg31qeNmYuIVe+JtUCUQqXRZdQBnwEX9JmTJ/Sx4V+QeAjc2C7gW+GWAlM7RdLw97EtBdaJjeL7/UBbxUcNNCM0y6cPB04/+6u5YwuFL7z9sMUPLdT9Ixt96uKjkY0+9rLcKz92W2ivdLZTCVa0ggtc4AIXuMAfFsiJOqhSR0wbOYh5GRrZyOh5rlVVm6hBIRuF5L7lFhpFlOl0uH4Z9OD9HaGHttlE51dZPQQ1NuNoU5Kyi+ELG0nNVE3dXGkfE7XMiJtuYx2w/3ixk2QMNc3ESMF4JEn7GrfQSTqcAd6VsMXFl0C+BJdgWuXnwMmgwlmyYgORQW8Tn9j1NdE7qTcKbQNaUCh0d7sZuKBw6lDioUdwIREW9KDXWe9x92kI7fZTvzSYwMv4Fw3E6MNfN2BRpYr/8wY3ChAG5tgoPJLu+6WGFyeq/qMGMPnPNXDhqwKvLvBR6TGd3qS3c/i93f1Ow+4dXsxvcHBwcHBwcHBwcHAgxTeZqyq9wtAXIgAAAABJRU5ErkJggg==" alt="Base64测试图片" class="img-fluid" style="max-height: 200px;">
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">Base64内联图片</div>
                    <div class="card-body">
                        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAACgCAMAAAC8EZcfAAAAWlBMVEX////29vaysrLy8vLu7u6np6fOzs7i4uK+vr7Z2dnCwsL8/Px5eXny8vLj4+NbW1s3NzcZGRkoKCgAAADe3t5ra2upqalQUFA/Pz8hISF+fn5ISEgQEBBjY2OTMQRGAAADuElEQVR4nO2b27KCMAxFCy1yv4hyfP//Mw+CgJZb23RX9jhrXmacZZuSpmkKgYODg4ODg4ODg4ODN3TNoF3NL2ikzz36Ql/UjfRZbBSVxTNKr9J/LGLhu6LFE2lctNJnYyEtXH5n6DIdTVqyWlsM9Pl+wUqe9hJVaeCbnGFoGKxHyTo0uG9jGbp7vFpv0nUB/kBKf77fsSl1wJM0qW8Y76Hu4P7Sdb2W79eiCwbDFT3yHnriogqmhsrJDj0PspBdQW1R1nI5byCwQmVVTb2BDcqrjBxpPLUEKJwPGHZvIIfCqlIXjWcmBqgKUuFEGHkWmK29GBRI0zzVQkgKVU4yxiIwXEWpZPQipPCaO0Y2SuiCUmYYRb0cSgtOJ+lzMw9FYnL8/SyvQ5nUmBnCrFy6raaLJiYG/lVgZIx5eXlGxK9nZqHCk4sJFYaYP2VkpYWi98T/xT2iFrbsH9FvWmF2cqoGF0bMn20+5vYSvOqkf0RYW/mZXNKwrj1A93CcvdU/obCWXGVTsEVXYH6i8wIiXaS4w/XwJEyFKxVqqOJu4YKmhQuwsY9YHw8OTaHfsCMVMECdmNzg/HcxQLqMJSp44P7Kh5pxeAstQRRtgIMKVHH3XK7RQc1ckPGE1kC41qUQbXSyZ28E+Iu5iQEGTJJnYv1aQsEkSNQOeJxMaXOTQFrFRpRZMh4hsMEklS3wvIdAo2hKfWqGQANp5eoQ3nwG2qg31qeNmYuIVe+JtUCUQqXRZdQBnwEX9JmTJ/Sx4V+QeAjc2C7gW+GWAlM7RdLw97EtBdaJjeL7/UBbxUcNNCM0y6cPB04/+6u5YwuFL7z9sMUPLdT9Ixt96uKjkY0+9rLcKz92W2ivdLZTCVa0ggtc4AIXuMAfFsiJOqhSR0wbOYh5GRrZyOh5rlVVm6hBIRuF5L7lFhpFlOl0uH4Z9OD9HaGHttlE51dZPQQ1NuNoU5Kyi+ELG0nNVE3dXGkfE7XMiJtuYx2w/3ixk2QMNc3ESMF4JEn7GrfQSTqcAd6VsMXFl0C+BJdgWuXnwMmgwlmyYgORQW8Tn9j1NdE7qTcKbQNaUCh0d7sZuKBw6lDioUdwIREW9KDXWe9x92kI7fZTvzSYwMv4Fw3E6MNfN2BRpYr/8wY3ChAG5tgoPJLu+6WGFyeq/qMGMPnPNXDhqwKvLvBR6TGd3qS3c/i93f1Ow+4dXsxvcHBwcHBwcHBwcHAgxTeZqyq9wtAXIgAAAABJRU5ErkJggg==" alt="Base64测试图片" class="img-fluid" style="max-height: 200px;">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="js/admin.js"></script>
    <script>
    // 添加图片加载事件监听
    document.addEventListener('DOMContentLoaded', function() {
        console.log('正在测试图片加载...');
        document.querySelectorAll('img').forEach(img => {
            img.addEventListener('load', function() {
                console.log('图片加载成功:', this.src);
            });
            img.addEventListener('error', function() {
                console.error('图片加载失败:', this.src);
            });
        });
    });
    </script>
</body>
</html> 